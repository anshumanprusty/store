<p id="notice"><%= notice %></p>

<div class="container">
<h1>Listing Orders</h1>

<table id="order" class="table table-striped" border="1">
  <thead>
    <tr>
      <th>Quantity</th>
      <th>Totalprice</th>
      <th colspan="3"><center>Action</center></th>
    </tr>
  </thead>

  <tbody id="orderlist">
          
  </tbody>
</table>

<br>

<%# Added Bootstrap data modal attribute %>
<%= link_to 'New Order', '#new_order_modal', 'data-toggle' => 'modal' %>

<%# Bootstrap modal markup. @see: http://getbootstrap.com/javascript/#modals %>
<div class="modal fade" id="new_order_modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title" id="myModalLabel">Create new person</h4>
      </div>
      <div class="modal-body">
        <%# Render the new person form (passing modal => true to enable remote => true) %>
        <%= render 'form' %>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>


<script>
$(document).ready(function(){

      $("#btnCreateOrder").click(function(e) {
        //alert("data");
        
        var url = "/orders"; // the script where you handle the form input.

    $.ajax({
           type: "POST",
           url: url,
           data: $("#new_order").serialize(), // serializes the form's elements.
           success: function(data)
           {
              //alert("Hello");
              $('#new_order_modal').modal('hide');

              listOrders();
              //window.close();
              //$.modal.close();

           }
         });
e.preventDefault(); 

});
});
</script>

<script type="text/javascript">
  $(function(){
      listOrders();
  });

  function listOrders() {

     var order_url = "/orders/list";

      $.ajax({
        //options.async = true;
        url: order_url,
        type: 'get',
        success: function(data) {
            if(data!=null && data.length>0){
              $("#orderlist").html('');
              $.each(data,function(index,key){
                //alert(index);
                //$("#orderlist").append("<tr><td>"+key.quantity+"</td><td>"+key.totalprice+"</td><td>Show</td><td>Edit</td><td>Destroy</td></tr>");
                $("#orderlist").html("<%= j render 'table_row' %>");
              })

                  }
                }
      });
}
function EditOrder(orderId){

}
function DeleteOrder(orderId){

}
function ShowOrder(orderId){

}
function SaveOrder(){

}
</script>

<br><br>
<%= link_to 'New Order', new_order_path, :onclick=>"window.open(this.href,'New Order', 'height=600, width=600');return false;" 
%>
</div>